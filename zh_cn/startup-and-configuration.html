<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="built-on" content="2024-08-01T14:56:17.1051778"><title>Startup and configuration | FooocusAPI</title><script type="application/json" id="virtual-toc-data">[{"id":"fooocusapi","level":0,"title":"FooocusAPI 选项","anchor":"#fooocusapi"},{"id":"fooocus","level":0,"title":"Fooocus 选项","anchor":"#fooocus"},{"id":"-6v3sl_9","level":0,"title":"端口配置","anchor":"#-6v3sl_9"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.10.0-b408/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Startup and configuration | FooocusAPI"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="FooocusAPI Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/docs/zh_cn/startup-and-configuration.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Startup and configuration | FooocusAPI"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/docs/zh_cn/startup-and-configuration.html#webpage",
    "url": "writerside-documentation/docs/zh_cn/startup-and-configuration.html",
    "name": "Startup and configuration | FooocusAPI",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/docs/#website",
    "url": "writerside-documentation/docs/",
    "name": "FooocusAPI Help"
}</script><!-- End Schema.org --></head><body data-id="Startup-and-configuration" data-main-title="Startup and configuration" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="Tutorial.md|Tutorial"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>FooocusAPI zh_cn Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Startup-and-configuration" id="Startup-and-configuration.md">Startup and configuration</h1><p id="-6v3sl_3">尽管称作配置，但 Fooocus 并没有独立的配置文件，几乎所有可调节的东西都是通过命令行进行，在重构时有过把这些选项改为配置文件的想法，不过还是选择了沿用 Fooocus 的做法。 这意味着，你无需改变使用习惯，仍可以按照 Fooocus 的方式启动 FooocusAPI。也因为配置都是通过命令行选项进行，所以启动和配置被放到了一起。</p><p id="-6v3sl_4">绝大多数情况下，无论是 Fooocus 还是 FooocusAPI，默认配置已经足够使用。但如果你想进行一些自定义配置，那么本章节将提供一些帮助。</p><aside class="prompt" data-type="tip" data-title="" id="-6v3sl_5"><p id="-6v3sl_10">本节中，将主要描述 FooocusAPI 新增的部分，以及受其影响的 Fooocus 部分，其他一些必要的部分也会被提及。</p></aside><p id="-6v3sl_6">你可以使用 <code class="code" id="-6v3sl_11">python launch.py --help</code> 参数查看所有可用的命令行参数。</p><section class="chapter"><h2 id="fooocusapi" data-toc="fooocusapi">FooocusAPI 选项</h2><p id="-6v3sl_12">这些配置选项是 FooocusAPI 独有的，用来控制 FooocusAPI 的行为。</p><ul class="list _bullet" id="-6v3sl_13"><li class="list__item" id="-6v3sl_14"><p><code class="code" id="-6v3sl_18">--nowebui</code>: 不启动 WebUI，只启动 API 服务。</p></li><li class="list__item" id="-6v3sl_15"><p><code class="code" id="-6v3sl_19">--base-url BASE_URL</code>: 用来替换返回的 URL 中的 <code class="code" id="-6v3sl_20">base_url</code> ，默认为 <code class="code" id="-6v3sl_21">http://127.0.0.1</code>。</p></li><li class="list__item" id="-6v3sl_16"><p><code class="code" id="-6v3sl_22">--apikey APIKEY</code>: 如果指定了该参数，那么请求 API 时，需要在 <code class="code" id="-6v3sl_23">header</code> 中添加 <code class="code" id="-6v3sl_24">X-API-KEY</code> ，否则返回 403。</p></li><li class="list__item" id="-6v3sl_17"><p><code class="code" id="-6v3sl_25">--webhook-url WEBHOOK_URL</code>: 指定该参数时，当任务完成时，会向该 URL 发送 POST 请求，这对异步任务非常有用，其优先级低于任务参数中传递的 <code class="code" id="-6v3sl_26">webhook_url</code>。</p></li></ul></section><section class="chapter"><h2 id="fooocus" data-toc="fooocus">Fooocus 选项</h2><p id="-6v3sl_27">这些是 Fooocus 原本就有的选项，但现在(可能)也会影响 FooocusAPI 的行为。</p><ul class="list _bullet" id="-6v3sl_28"><li class="list__item" id="-6v3sl_31"><p><code class="code" id="-6v3sl_35">--listen [IP]</code>: 用来指定监听的 IP 地址，默认为 <code class="code" id="-6v3sl_36">127.0.0.1</code> ，如果不指定具体的值，仅指定 <code class="code" id="-6v3sl_37">--listen</code> ，等同于指定 <code class="code" id="-6v3sl_38">--listen 0.0.0.0</code> 。该参数同时影响 WebUI 和 API 服务。</p></li><li class="list__item" id="-6v3sl_32"><p><code class="code" id="-6v3sl_39">--port PORT</code>: 用来指定监听的端口，默认为 <code class="code" id="-6v3sl_40">7865</code>, API 默认使用该端口 <code class="code" id="-6v3sl_41">+1</code> 的端口，该参数同时影响 WebUI 和 API 服务。</p></li><li class="list__item" id="-6v3sl_33"><p><code class="code" id="-6v3sl_42">--output-path OUTPUT_PATH</code>: 用来指定输出路径，默认为会输出到项目根目录下的 <code class="code" id="-6v3sl_43">outputs</code> 文件夹中，当前我不建议修改该选项，原因是当前版本没有对这个进行测试，可能会影响 API 结果路径的准确性。</p></li><li class="list__item" id="-6v3sl_34"><p><code class="code" id="-6v3sl_44">--disable-image-log</code>: 用来禁止保存图像，即不保存图片到 <code class="code" id="-6v3sl_45">output_path</code> 中，禁用会导致 API 服务无法正常工作。</p></li></ul><p id="-6v3sl_29">还有一些选项，主要影响 WebUI 的行为，对 API 无效：</p><ul class="list _bullet" id="-6v3sl_30"><li class="list__item" id="-6v3sl_46"><p><code class="code" id="-6v3sl_54">--in-browser</code></p></li><li class="list__item" id="-6v3sl_47"><p><code class="code" id="-6v3sl_55">--disable-in-browser</code></p></li><li class="list__item" id="-6v3sl_48"><p><code class="code" id="-6v3sl_56">--disable-preset-selection</code></p></li><li class="list__item" id="-6v3sl_49"><p><code class="code" id="-6v3sl_57">--disable-server-info</code></p></li><li class="list__item" id="-6v3sl_50"><p><code class="code" id="-6v3sl_58">--language LANGUAGE</code></p></li><li class="list__item" id="-6v3sl_51"><p><code class="code" id="-6v3sl_59">--theme THEME</code></p></li><li class="list__item" id="-6v3sl_52"><p><code class="code" id="-6v3sl_60">--disable-analytics</code></p></li><li class="list__item" id="-6v3sl_53"><p><code class="code" id="-6v3sl_61">--enable-auto-describe-image</code></p></li></ul></section><section class="chapter"><h2 id="-6v3sl_9" data-toc="-6v3sl_9">端口配置</h2><p id="-6v3sl_62">Fooocus 有两种方式修改其 WebUI 监听的端口，分别是通过 <code class="code" id="-6v3sl_64">--port PORT</code> 和环境变量 <code class="code" id="-6v3sl_65">GRADIO_SERVER_PORT</code>。 这两种方式都会影响 API 服务的端口，除此之外，还可以通过环境变量 <code class="code" id="-6v3sl_66">API_PORT</code> 单独修改 API 服务的端口。它们的优先级为： <code class="code" id="-6v3sl_67">API_PORT &gt; --port PORT &gt; GRADIO_SERVER_PORT</code></p><aside class="prompt" data-type="tip" data-title="" id="-6v3sl_63"><p id="-6v3sl_68">之所以变成这样一个原因是我觉得没必要单独增加一个选项来修改 API 服务的端口，而且使用率低，所以复用了 WebUI 的端口配置。但更改端口又确实有需求，使用 <code class="code" id="-6v3sl_69">--port PORT</code> 尽管也可以，但不够直观，所以增加了 <code class="code" id="-6v3sl_70">API_PORT</code>。 另一个原因是为了降低配置要求，即开箱即用，不需要额外配置，此时沿用 WebUI 的端口可以尽可能保留用户的使用习惯。</p></aside></section><div class="last-modified">Last modified: 01 八月 2024</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="taskobject.html" class="navigation-links__prev">TaskObject</a><a href="generateendpoint.html" class="navigation-links__next">Generate</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.10.0-b408/app.js"></script></body></html>